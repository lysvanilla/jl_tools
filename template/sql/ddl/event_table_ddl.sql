/*
Purpose:    快照/流水表建表脚本，此脚本由生成引擎自动生成。
Author:     Sunline
CreateDate: 20180515
FileType:   DDL
Logs:
    sunlinedata 2025-03-05 新建脚本
    Version: 1.2
*/
-- 1.0 drop table if exists table
drop table if exists pm_ridata.${table_name_en};

-- 1.1 create table
create table pm_ridata.${table_name_en}
(
     part_dt varchar(10) default null comment '分区日期'
    ,src_tab_nm varchar(500) default null comment '源表名称'
    ,lpr_org_id varchar(10) default null comment '法人机构编号'
    ,@{column_name_en} @{column_type} @{if_null} comment '@{column_name_cn}'
)comment '${table_name_cn}'
PARTITIONED BY RANGE (part_dt)
(
PARTITION before_202501 VALUES LESS THAN ('20250132'),
PARTITION before_202502 VALUES LESS THAN ('20250232'),
PARTITION before_202503 VALUES LESS THAN ('20250332'),
PARTITION before_202504 VALUES LESS THAN ('20250432'),
PARTITION before_202505 VALUES LESS THAN ('20250532'),
PARTITION before_202506 VALUES LESS THAN ('20250632'),
PARTITION before_202507 VALUES LESS THAN ('20250732'),
PARTITION before_202508 VALUES LESS THAN ('20250832'),
PARTITION before_202509 VALUES LESS THAN ('20250932'),
PARTITION before_202510 VALUES LESS THAN ('20251032'),
PARTITION before_202511 VALUES LESS THAN ('20251132'),
PARTITION before_202512 VALUES LESS THAN ('20251232'),
PARTITION before_202601 VALUES LESS THAN ('20260132'),
PARTITION before_202602 VALUES LESS THAN ('20260232'),
PARTITION before_202603 VALUES LESS THAN ('20260332'),
PARTITION before_202604 VALUES LESS THAN ('20260432'),
PARTITION before_202605 VALUES LESS THAN ('20260532'),
PARTITION before_202606 VALUES LESS THAN ('20260632'),
PARTITION before_202607 VALUES LESS THAN ('20260732'),
PARTITION before_202608 VALUES LESS THAN ('20260832'),
PARTITION before_202609 VALUES LESS THAN ('20260932'),
PARTITION before_202610 VALUES LESS THAN ('20261032'),
PARTITION before_202611 VALUES LESS THAN ('20261132'),
PARTITION before_202612 VALUES LESS THAN ('20261232'),
PARTITION before_202701 VALUES LESS THAN ('20270132'),
PARTITION before_202702 VALUES LESS THAN ('20270232'),
PARTITION before_202703 VALUES LESS THAN ('20270332'),
PARTITION before_202704 VALUES LESS THAN ('20270432'),
PARTITION before_202705 VALUES LESS THAN ('20270532'),
PARTITION before_202706 VALUES LESS THAN ('20270632'),
PARTITION before_202707 VALUES LESS THAN ('20270732'),
PARTITION before_202708 VALUES LESS THAN ('20270832'),
PARTITION before_202709 VALUES LESS THAN ('20270932'),
PARTITION before_202710 VALUES LESS THAN ('20271032'),
PARTITION before_202711 VALUES LESS THAN ('20271132'),
PARTITION before_202712 VALUES LESS THAN ('20271232'),
PARTITION before_202801 VALUES LESS THAN ('20280132'),
PARTITION before_202802 VALUES LESS THAN ('20280232'),
PARTITION before_202803 VALUES LESS THAN ('20280332'),
PARTITION before_202804 VALUES LESS THAN ('20280432'),
PARTITION before_202805 VALUES LESS THAN ('20280532'),
PARTITION before_202806 VALUES LESS THAN ('20280632'),
PARTITION before_202807 VALUES LESS THAN ('20280732'),
PARTITION before_202808 VALUES LESS THAN ('20280832'),
PARTITION before_202809 VALUES LESS THAN ('20280932'),
PARTITION before_202810 VALUES LESS THAN ('20281032'),
PARTITION before_202811 VALUES LESS THAN ('20281132'),
PARTITION before_202812 VALUES LESS THAN ('20281232'),
PARTITION before_202901 VALUES LESS THAN ('20290132'),
PARTITION before_202902 VALUES LESS THAN ('20290232'),
PARTITION before_202903 VALUES LESS THAN ('20290332'),
PARTITION before_202904 VALUES LESS THAN ('20290432'),
PARTITION before_202905 VALUES LESS THAN ('20290532'),
PARTITION before_202906 VALUES LESS THAN ('20290632'),
PARTITION before_202907 VALUES LESS THAN ('20290732'),
PARTITION before_202908 VALUES LESS THAN ('20290832'),
PARTITION before_202909 VALUES LESS THAN ('20290932'),
PARTITION before_202910 VALUES LESS THAN ('20291032'),
PARTITION before_202911 VALUES LESS THAN ('20291132'),
PARTITION before_202912 VALUES LESS THAN ('20291232')
)
CLUSTERED BY (${bucketKey})
INTO 37 BUCKETS
ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.orc.OrcSerde'
WITH SERDEPROPERTIES ('serialization.format'='1')
STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
TBLPROPERTIES ('transactional'='true');